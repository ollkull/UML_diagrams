@startuml
Actor "Пользователь" as u
participant "Мобильное приложение" as a
participant "Сервер банка" as s
participant "Система обработки платежей" as p
participant "Получатель" as r

u -> a: вводит логин и пароль
activate a
a -> s: отправить данные для аутентификации 
activate s
s -> s: проверить данные 
alt Неудачная аутентификация
    s --> a: Ошибка входа
    a --> u: Неверный логин или пароль
else Успешная аутентификация 
    s --> a: подтверждение аутентификации
    deactivate s
    a -> a: открыть личный кабинет
end
deactivate a

u -> a: открыть раздел переводы
activate a
a -> a: открыть интерфейс переводов
u -> a: вводит сумму и данные получателя
a -> s: отправить запрос на перевод 
activate s
s -> s: проверить данные получателя
alt Получатель не найден 
    s --> a: ошибка: получатель не найден
    deactivate s
    a --> u: получатель не найден
    deactivate a
else Получатель найден
    activate s
    s -> p: запрос на перевод средств
    activate p
    deactivate s
    p -> p: проверить баланс отправителя
    alt Недостаточно средств
        p --> s: ошибка: недостаточно средств
        activate s
        s --> a: недостаточно средств
        activate a
        a --> u: недостаточно средств
    else Средств достаточно
        p --> s: подтвердить перевод средств
        deactivate p
        s --> a: перевод одобрен
        deactivate s
        a --> u: показать форму подтверждения перевода
        deactivate a
    end
end

u -> a: подтвердить перевод
activate a
a -> s: отправить подтверждение перевода 
activate s
s -> p: подтвердить выполнение перевода
activate p
p ->> r: отправить перевод получателю
p --> s: перевод совершен
deactivate p
s --> a: перевод выполнен
deactivate s
a --> u: перевод выполнен
deactivate a

@enduml